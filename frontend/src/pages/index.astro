---
import NavBarComponent from "../components/astro/menu/NavBarComponent.astro";
import "./../style/elements.scss";
---

<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/ico" href="/favicon.ico" />
		<meta name="viewport" content="width=device-width" />
		<meta name="generator" content={Astro.generator} />
		<title>Starchess</title>
		<!-- normalize css -->
		<style is:inline>
			@import url("https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css");
			@import url("https://tympanus.net/Development/TextInputEffects/css/normalize.css");
		</style>
		<style>
			.container {
				overflow-x: hidden;
				background-color: rgb(241, 246, 248);
				display: flex;
			}

			.menu {
				width: 100%;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
			}
		</style>
	</head>
	<body>
		<div class={"container"}>
			<NavBarComponent />
			<!-- <MenuComponent /> -->
			<div class="menu">
				<button id="new-game">New game</button>
			</div>
			<script>
				import { GameMode } from "../../../backend/gameServer/src/helpers/types";

				const button = document.getElementById("new-game");
				button?.addEventListener("click", () => {
					fetch(
						`http://${import.meta.env.PUBLIC_BASE_URL}:${
							import.meta.env.PUBLIC_BACKEND_PORT
						}/newCustomGame`,
						{
							method: "POST",
							body: JSON.stringify({ gameMode: GameMode.Default }),
						}
					)
						.then((res) => res.json())
						.then((data) => {
							window.location.href = `http://${
								import.meta.env.PUBLIC_BASE_URL
							}:${import.meta.env.PUBLIC_FRONTEND_PORT}/game/${data.gameId}`;
						});
				});
			</script>

			<!-- <GameComponent gameId="" client:load /> -->
		</div>
	</body>
</html>
